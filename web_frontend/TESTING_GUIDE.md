# 网页前端测试指南

## 测试环境

- **后端服务**: http://localhost:5000 (已启动)
- **前端服务**: http://localhost:8082 (已启动)
- **浏览器**: Chrome/Edge/Firefox

## 测试清单

### ✅ 1. 页面加载测试
- [ ] 访问 http://localhost:8082
- [ ] 检查页面是否正确显示
- [ ] 检查左侧控制面板是否完整
- [ ] 检查右侧预览区是否显示

### ✅ 2. 文本输入功能
- [ ] 在文本框中输入测试文字
- [ ] 检查字数统计是否实时更新
- [ ] 检查页数估算是否正确
- [ ] 测试文本保存到localStorage

### ✅ 3. 文件上传功能
- [ ] 点击"选择Word文件"上传.docx文件
- [ ] 点击"收藏输入文件"上传.txt文件
- [ ] 检查文字是否正确提取
- [ ] 检查错误处理（上传无效文件）

### ✅ 4. 字体选择功能
- [ ] 下拉菜单显示所有可用字体
- [ ] 选择不同字体
- [ ] 检查字体列表是否从后端正确加载

### ✅ 5. 纸张类型设置
- [ ] 选择"横线"纸张
- [ ] 选择"白底"纸张
- [ ] 选择"自定义背景"并上传图片
- [ ] 检查背景图片是否正确显示文件名

### ✅ 6. 参数调整
- [ ] 调整随机扰动强度滑块（0-100%）
- [ ] 展开"高级设置"
- [ ] 调整字体大小、字间距、行间距
- [ ] 调整四边边距
- [ ] 调整涂改概率
- [ ] 调整墨水深度
- [ ] 检查所有输入框是否正常工作

### ✅ 7. 预览功能测试
**前提**: 确保后端服务运行正常

- [ ] 输入测试文字（例如："这是一个测试文本，用于测试手写效果。"）
- [ ] 选择一个字体
- [ ] 点击"点击预览"按钮
- [ ] 等待加载（应显示loading动画）
- [ ] 检查右侧预览区是否显示手写图片
- [ ] 检查是否显示成功提示

**预期结果**: 
- Loading overlay显示"正在生成预览..."
- 预览图片显示在右侧
- 显示绿色成功提示"预览生成成功"

### ✅ 8. 下载文档功能测试
**前提**: 需要一个有效的6位相思豆码

#### 步骤A: 创建测试相思豆码
```bash
# 在后端目录运行
curl -X POST http://localhost:5000/api/admin/loveseed/create \
  -H "Content-Type: application/json" \
  -H "X-Admin-Token: admin123" \
  -d '{"loveseed_code":"123456","download_count":10}'
```

或者使用管理员页面创建。

#### 步骤B: 测试下载流程
- [ ] 输入测试文字
- [ ] 选择字体
- [ ] 点击"下载文档"按钮
- [ ] 相思豆弹窗出现
- [ ] 输入测试相思豆码（例如：123456）
- [ ] 点击"验证并生成"
- [ ] 等待生成（应显示loading）
- [ ] PDF文件自动下载
- [ ] 显示成功提示

**预期结果**:
- 弹窗正确显示
- 相思豆验证成功
- PDF文件下载到本地
- 文件名为"handwriting.pdf"

### ✅ 9. 错误处理测试
- [ ] 不输入文字直接预览 → 应提示"请先输入或上传文本内容"
- [ ] 不选择字体直接预览 → 应提示"请选择字体"
- [ ] 输入无效相思豆码 → 应提示"相思豆无效"
- [ ] 后端服务关闭时操作 → 应显示网络错误提示

### ✅ 10. 响应式布局测试
- [ ] 调整浏览器窗口大小
- [ ] 检查移动设备视图（开发者工具）
- [ ] 检查iPad视图
- [ ] 检查桌面视图

### ✅ 11. localStorage测试
- [ ] 输入文字并刷新页面 → 文字应保留
- [ ] 调整参数并刷新页面 → 参数应保留
- [ ] 清除浏览器数据 → 恢复默认设置

### ✅ 12. UI交互测试
- [ ] 高级设置折叠/展开动画流畅
- [ ] 滑块拖动顺畅
- [ ] 按钮hover效果正常
- [ ] Loading动画正常显示
- [ ] 提示消息3秒后自动消失
- [ ] Modal弹窗点击外部关闭

## 常见问题排查

### 问题1: 字体列表为空
**原因**: 后端字体文件夹没有.ttf文件
**解决**: 在backend/font_assets/目录添加.ttf字体文件

### 问题2: 预览失败
**原因**: 
- 后端服务未启动
- CORS配置问题
- 参数缺失

**解决**:
1. 检查后端是否在5000端口运行
2. 检查浏览器Console是否有CORS错误
3. 检查是否选择了字体

### 问题3: 下载失败
**原因**: 相思豆码无效或已用完
**解决**: 创建新的相思豆码或使用管理员功能

### 问题4: 文件上传失败
**原因**: 文件格式不支持或文件损坏
**解决**: 
- 确保文件是.docx, .pdf, .txt格式
- 检查文件是否损坏

## 性能测试

### 测试大文本处理
- [ ] 输入100字 → 应快速显示
- [ ] 输入500字 → 预览时间<5秒
- [ ] 输入1000字 → 预览时间<10秒
- [ ] 输入5000字 → 检查是否有性能警告

### 测试多页生成
- [ ] 生成1页 → 应在3秒内完成
- [ ] 生成5页 → 应在15秒内完成
- [ ] 生成10页 → 检查是否超时

## 浏览器兼容性测试

| 浏览器 | 版本 | 状态 | 备注 |
|--------|------|------|------|
| Chrome | 最新 | ✅ | 完全支持 |
| Firefox | 最新 | ✅ | 完全支持 |
| Edge | 最新 | ✅ | 完全支持 |
| Safari | 最新 | ⚠️ | 部分功能需测试 |
| IE11 | - | ❌ | 不支持 |

## 测试报告模板

```
测试日期: ____________________
测试人员: ____________________
浏览器: ______________________
操作系统: ____________________

测试结果:
□ 所有功能正常
□ 发现问题（详见下方）

问题清单:
1. ________________________________
2. ________________________________
3. ________________________________

建议:
________________________________
________________________________
```

## 自动化测试（未来计划）

- 使用Selenium进行UI自动化测试
- 使用Jest进行单元测试
- 使用Cypress进行端到端测试

## 总结

完成所有测试项后，网页前端应能：
1. 正确加载并显示所有UI元素
2. 与后端API正常通信
3. 处理用户输入和文件上传
4. 生成预览和PDF文件
5. 正确处理各种错误情况
6. 在不同设备上响应式显示
